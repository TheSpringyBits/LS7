Z0 = $00
Z1 = $01
Z2 = $02

K1 = $0200
K2 = $0201
K3 = $0202
K4 = $0203
PAL = $0204
PP = $0205

		;VIA REGS
PORTA = $BF01
PORTB = $BF00
DDRB = $BF02
DDRA = $BF03
T1CL = $BF04
T1CH = $BF05
ACR = $BF0B
IFR = $BF0D
IER = $BF0E

		;VIDEO REGS
VIDX = $BE00					;X REG
VIDY = $BE01					;Y REG
VIDM = $BE02					;MOG REG
VIDD = $BE03					;DATA REG

	.ORG $C000
WRITE:
	STX VIDX
	STY VIDY
	STA VIDD
	NOP
	STX VIDX
	STY VIDY
	STA VIDD
	NOP
	STX VIDX
	RTS
DRAW_RECT:								;K1=X CORD END , K2=Y CORD END, X=X CORD BEGIN, Y=Y CORD BEGIN, A=FILL VALUE
	STX K3
	INC K1
	INC K2
DRAW_RECT_LOOP
	JSR WRITE
	INX
	CPX K1
	BNE DRAW_RECT_LOOP
	LDX K3
	INY
	CPY K2
	BNE DRAW_RECT_LOOP
	LDX K3
	RTS
PRINT_TEXT:								;Z1=LOW TEXT ADDRESS, Z2=HIGH TEXT ADRESS, X=X BEGIN, Y=Y BEGIN
	STY K1
	LDY #$00
	STY K2
PRINT_TEXT_LOOP:
	LDY K2
	LDA (Z1), Y
	CMP #$FF
	BEQ RETURN_1
	CPY #$FF
	BEQ RETURN_1
	INC K2
	LDY K1
	JSR WRITE
	INX
	JMP PRINT_TEXT_LOOP
RETURN_1:
	RTS
LOWER_UPPER:
	CMP #$24
	BCS RETURN
	CMP #$0A
	BCC RETURN
	CLC
	ADC #$30
	RTS
RETURN:	
	RTS
RESET:
	SEI
	LDA #$FF
	STA DDRB
	LDA #$00
	STA DDRA
	STA PP
	LDA #$07
	STA PAL
	LDA #$04
	STA PORTB
	LDA #$0E	
	STA VIDM

	LDA #$7F						;X END
	STA K1
	LDA #$20						;Y END
	STA K2
	LDA #$F0						;VALUE
	LDX #$00						;X START
	LDY #$00						;Y START
	JSR DRAW_RECT						;CLEAR CHARACTERS

	LDA #$54						;X END
	STA K1
	LDA #$14						;Y END
	STA K2
	LDA #$70						;VALUE
	LDX #$41						;X START
	LDY #$01						;Y START
	JSR DRAW_RECT						;CLEAR COLOR ATTRIBUTE

	LDA #$12						;X END
	STA K1
	LDA #$17						;Y END
	STA K2
	LDA #$FF						;VALUE
	LDX #$03						;X START
	LDY #$16						;Y START
	JSR DRAW_RECT						;CLEAR COLOR ATTRIBUTE

	LDA #$3C
	LDX #$70
	LDY #$F0
	JSR WRITE
	LDA #$76
	INX
	JSR WRITE
	LDA #$FF
	INX
	JSR WRITE
	LDA #$E0
	INX
	JSR WRITE
	LDA #$FF
	INX
	JSR WRITE
	LDA #$7E
	INX
	JSR WRITE
	LDA #$3C
	INX
	JSR WRITE
	LDA #$00
	INX
	JSR WRITE

	LDX #<PALETTE_TEXT
	STX Z1
	LDX #>PALETTE_TEXT
	STX Z2
	LDX #$16
	LDY #$01
	JSR PRINT_TEXT	

	LDA #$2B
	LDX #$17
	LDY #$04
	JSR WRITE
	LDA #$B0
	INX
	JSR WRITE
	INX
	JSR WRITE
	INX
	JSR WRITE
	INX
	LDA #$2A
	JSR WRITE

	LDA #$FF
	LDX #$18
	LDY #$03
	JSR WRITE
	INX
	JSR WRITE
	INX
	JSR WRITE
	LDA #$01
	LDX #$58
	JSR WRITE
	INX
	LDA #$02
	JSR WRITE
	INX
	LDA #$04
	JSR WRITE

	LDA PAL
	LDX #$1D
	LDY #$04
	JSR WRITE

	LDA #$00
	LDX #$03
	LDY #$03
	STA K1
FILL_MAP:
	LDA K1
	JSR WRITE
	INX
	INC K1
	CPX #$13
	BNE FILL_MAP
	LDX #$03
	INY
	CPY #$13
	BNE FILL_MAP
	LDA #$00
	LDX #$03
	LDY #$01
	STA K1
FILL_X:
	LDA K1
	JSR LOWER_UPPER
	JSR WRITE
	INX
	INC K1
	CPX #$13
	BNE FILL_X
	LDA #$00
	LDX #$03
	LDY #$14
	STA K1
FILL_X_2:
	LDA K1
	JSR LOWER_UPPER
	JSR WRITE
	INX
	INC K1
	CPX #$13
	BNE FILL_X_2
	LDA #$00
	LDX #$01
	LDY #$03
	STA K1
FILL_Y:
	LDA K1
	JSR LOWER_UPPER
	JSR WRITE
	INY
	INC K1
	CPY #$13
	BNE FILL_Y
	LDA #$00
	LDX #$14
	LDY #$03
	STA K1
FILL_Y_2:
	LDA K1
	JSR LOWER_UPPER
	JSR WRITE
	INY
	INC K1
	CPY #$13
	BNE FILL_Y_2
	LDA #$00
	LDX #$43
	LDY #$16
	STA K1
FILL_COLOR:
	LDA K1
	JSR WRITE
	INY
	JSR WRITE
	DEY
	INX
	INC K1
	CPX #$53
	BNE FILL_COLOR
	

	
LOOP:
	LDA PORTA
	CMP PP
	BEQ LOOP
	STA PP

	CMP #$01
	BEQ LEFT
	CMP #$04
	BEQ RIGHT

	LDA #$F8
	LDX #$57
	LDY #$04
	JSR WRITE
	LDX #$5B
	JSR WRITE
	JMP LOOP

LEFT:
	LDA #$8F
	LDX #$57
	LDY  #$04
	JSR WRITE
	LDA PAL
	CMP #$00
	BEQ LOOP_CONTINUE
	DEC PAL
	JMP LOOP_CONTINUE
RIGHT:
	LDA #$8F
	LDX #$5B
	LDY #$04
	JSR WRITE
	LDA PAL
	CMP #$07
	BCS LOOP
	INC PAL
	JMP LOOP_CONTINUE

PAL_0:
	LDA #$F0
	JSR WRITE
	INX
	JSR WRITE
	INX
	JSR WRITE
	JMP LOOP
PAL_1:
	LDA #$B0
	JSR WRITE
	LDA #$F0
	INX
	JSR WRITE
	INX
	JSR WRITE
	JMP LOOP
PAL_2:
	LDA #$F0
	JSR WRITE
	LDA #$B0
	INX
	JSR WRITE
	LDA #$F0
	INX
	JSR WRITE
	JMP LOOP
PAL_3:
	LDA #$B0
	JSR WRITE
	INX
	JSR WRITE
	LDA #$F0
	INX
	JSR WRITE
	JMP LOOP
PAL_4:
	LDA #$F0
	JSR WRITE
	INX
	JSR WRITE
	LDA #$B0
	INX
	JSR WRITE
	JMP LOOP
LOOP_CONTINUE:
	LDA PAL
	LDX #$1D
	LDY #$04
	JSR WRITE
	CLC
	ROL
	STA VIDM

	LDA PAL
	LDX #$18
	LDY #$04
	CMP #$00
	BEQ PAL_0
	CMP #$01
	BEQ PAL_1
	CMP #$02
	BEQ PAL_2
	CMP #$03
	BEQ PAL_3
	CMP #$04
	BEQ PAL_4
	CMP #$05
	BEQ PAL_5
	CMP #$06
	BEQ PAL_6
	CMP #$07
	BEQ PAL_7
	JMP LOOP
PAL_5:
	LDA #$B0
	JSR WRITE
	LDA #$F0
	INX
	JSR WRITE
	LDA #$B0
	INX
	JSR WRITE
	JMP LOOP
PAL_6:
	LDA #$F0
	JSR WRITE
	LDA #$B0
	INX
	JSR WRITE
	INX
	JSR WRITE
	JMP LOOP
PAL_7:
	LDA #$B0
	JSR WRITE
	INX
	JSR WRITE
	INX
	JSR WRITE
	JMP LOOP

PALETTE_TEXT:
	.BYTE $49
	.BYTE $3A
	.BYTE $45
	.BYTE $4D
	.BYTE $4D
	.BYTE $3E
	.BYTE $54
	.BYTE $FF

	.ORG $FFFA
	.WORD RESET
	.WORD RESET
	.WORD RESET






